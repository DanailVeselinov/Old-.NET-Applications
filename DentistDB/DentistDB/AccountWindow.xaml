<Window x:Class="DentistDB.AccountWindow" x:Name="AccountW"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:DentistDB"
        Title="AccountWindow" SizeToContent="WidthAndHeight" Background="Aqua">
    <Window.Resources>
        <local:HeightValueConverter x:Key="HeightValueConverter"/>
    </Window.Resources>
    <ScrollViewer CanContentScroll="True"  HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
    <StackPanel>
        <StackPanel Orientation="Horizontal" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}">
            <Label Content="От:" Target="{Binding ElementName=FromDP}" FontWeight="Bold"/>
            <DatePicker Name="FromDP" SelectedDateChanged="FromDP_SelectedDateChanged"/>
            <Label Content="До:" Target="{Binding ElementName=ToDP}" FontWeight="Bold"/>
            <DatePicker Name="ToDP" SelectedDateChanged="FromDP_SelectedDateChanged"/>
                <CheckBox x:Name="IsDeletedCB" Checked="IsDeletedCB_Checked" Unchecked="IsDeletedCB_Checked" Content="Покажи и изтритите операции" IsChecked="False"/>
                <Button Margin="5,0" Click="Button_Click">Refresh</Button>
            </StackPanel>
            <Label Content="Доктор:" Target="{Binding ElementName=DoctorsCB}" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}" FontWeight="Bold"/>
        <ComboBox Name="DoctorsCB" ItemsSource="{Binding}" SelectionChanged="FromDP_SelectedDateChanged"  Margin="0,0,0,5" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Name}"/>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <StackPanel Orientation="Horizontal">
            <StackPanel Orientation="Vertical">
                <StackPanel Orientation="Horizontal" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}">
                    <Label Content="Обща сума за периода:" Target="{Binding ElementName=TotalTB}" FontWeight="Bold"/>
                    <TextBlock Name="TotalTB"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}" >
                    <Label Content="Обща сума по НЗОК:" Target="{Binding ElementName=TotalNOITB}" FontWeight="Bold"/>
                    <TextBlock Name="TotalNOITB"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}">
                    <Label Content="Обща сума Техник:" Target="{Binding ElementName=TotalDTTB}" FontWeight="Bold"/>
                    <TextBlock Name="TotalDTTB"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.1'}">
                    <Label Content="Общао Разходи:" Target="{Binding ElementName=TotalExpences}" FontWeight="Bold"/>
                    <TextBlock Name="TotalExpences"/>
                </StackPanel>
            </StackPanel>
                <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" MaxWidth="350" MaxHeight="400">
            <StackPanel Orientation="Vertical" Margin="20,0,0,0">
                <Label Content="Разходи" Target="{Binding ElementName=InvoicesDG}" FontWeight="Bold"/>
                <DataGrid Name="InvoicesDG" ItemsSource="{Binding}" AutoGenerateColumns="False" MaxHeight="200" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.CanContentScroll="True" CanUserAddRows="False" CanUserDeleteRows="False"  MouseDoubleClick="InvoicesDG_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Фирма" Binding="{Binding SupplierName,Mode=OneWay}"/>
                        <DataGridTextColumn Header="Номер" Binding="{Binding InvoiceNumber,Mode=OneWay}"/>
                        <DataGridTextColumn Header="Дата" Binding="{Binding DateOfPayment,Mode=OneWay, StringFormat=\{0:dd.MMM.yy hh:mm\}}"/>
                        <DataGridCheckBoxColumn Header="В брой" Binding="{Binding IsCashPayment, Mode=OneWay}"/>
                        <DataGridTextColumn Header="Сума" Binding="{Binding Sum,Mode=OneWay, StringFormat=\{0:N2\}}"/>
                        <DataGridTextColumn Header="#" Binding="{Binding Currency, Mode=OneWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </StackPanel>
                </ScrollViewer>
            </StackPanel>
            <DataGrid Name="TasksDG" ItemsSource="{Binding}" MaxHeight="{Binding Path=ActualHeight,ElementName=AccountW,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource HeightValueConverter},ConverterParameter='0.7'}" AutoGenerateColumns="False"  MouseDoubleClick="TasksDG_MouseDoubleClick">
            <DataGrid.Columns>
                    <DataGridTextColumn Header="Дата" Binding="{Binding Date,Mode=OneWay, StringFormat=\{0:dd.MMM.yy hh:mm\}}"/>
                    <DataGridTextColumn Header="Пациент" Binding="{Binding ClientId,Mode=OneWay}"/>
                    <DataGridTextColumn Header="Доктор" Binding="{Binding DoctorId,Mode=OneWay}"/>
                    <DataGridTextColumn Header="Зъб" Binding="{Binding ToothCode,Mode=OneWay}"/>
                    <DataGridTextColumn Header="Статус" Binding="{Binding Status,Mode=OneWay}" MaxWidth="100"/>
                    <DataGridTextColumn Header="Цена" Binding="{Binding Price,Mode=OneWay,StringFormat=\{0:F2\}}" MaxWidth="50"/>
                    <DataGridTextColumn Header="Цена по НЗОК" Binding="{Binding PriceNOI,Mode=OneWay,StringFormat=\{0:F2\}}" MaxWidth="50"/>
                    <DataGridTextColumn Header="Цена Техник" Binding="{Binding PriceDT,Mode=OneWay,StringFormat=\{0:F2\}}" MaxWidth="50"/>
                    <DataGridTextColumn Header="Диагноза" Binding="{Binding Diagnose,Mode=OneWay}" MaxWidth="500"/>
                    <DataGridCheckBoxColumn Header="Платен" Binding="{Binding IsPaid,Mode=OneWay}" MaxWidth="500"/>
                    <DataGridCheckBoxColumn Header="Изтрит" Binding="{Binding IsDeleted,Mode=OneWay}" MaxWidth="500"/>
                </DataGrid.Columns>
        </DataGrid>
        
    </StackPanel>
    </ScrollViewer>
</Window>
